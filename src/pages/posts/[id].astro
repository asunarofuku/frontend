---
export const prerender = true;

import Post from "../../components/posts/Post.astro";
import { REST_API_URL } from "../../components/site";

/**
 * すべての slug を取得して静的パスを作成する
 */
export async function getStaticPaths() {
  const res = await fetch(`${REST_API_URL}posts?per_page=0&page=0`);
  if (!res.ok) throw new Error("Failed to fetch posts");

  const posts = await res.json();

  return posts.pageItems.map((post) => ({
    params: { id: post.id },
    props: { post },  // ページにデータを渡す
  }));
}

const { post } = Astro.props;

    const res = await fetch(`${REST_API_URL}show?id=${post.id}`);
    const data = await res.json();

---

<Post post={data} subTitle="お知らせ" />
